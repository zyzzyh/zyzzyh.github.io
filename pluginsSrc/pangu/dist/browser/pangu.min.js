((e,t)=>{"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("pangu",[],t):"object"==typeof exports?exports.pangu=t():e.pangu=t()})(window,function(){return n=[function(n,e,a){var t;void 0!==(e="function"==typeof(t=function(){function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var e=(e=>{function t(){var e;if(this instanceof t)return(e=((e,t)=>{if(!t||"object"!==c(t)&&"function"!=typeof t){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}return t})(this,s(t).call(this))).blockTags=/^(div|p|h1|h2|h3|h4|h5|h6)$/i,e.ignoredTags=/^(script|code|pre|textarea)$/i,e.presentationalTags=/^(b|code|del|em|i|s|strong)$/i,e.spaceLikeTags=/^(br|hr|i|img|pangu)$/i,e.spaceSensitiveTags=/^(a|del|pre|s|strike|u)$/i,e.isAutoSpacingPageExecuted=!1,e;throw new TypeError("Cannot call a class as a function")}var n=t;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&u(n,e);for(var a=t.prototype,o=[{key:"isContentEditable",value:function(e){return e.isContentEditable||e.getAttribute&&"true"===e.getAttribute("g_editable")}},{key:"isSpecificTag",value:function(e,t){return e&&e.nodeName&&0<=e.nodeName.search(t)}},{key:"isInsideSpecificTag",value:function(e,t){var n=e;if(2<arguments.length&&void 0!==arguments[2]&&arguments[2]&&this.isSpecificTag(n,t))return!0;for(;n.parentNode;)if(n=n.parentNode,this.isSpecificTag(n,t))return!0;return!1}},{key:"canIgnoreNode",value:function(e){var t=e;if(t&&(this.isSpecificTag(t,this.ignoredTags)||this.isContentEditable(t)))return!0;for(;t.parentNode;)if((t=t.parentNode)&&(this.isSpecificTag(t,this.ignoredTags)||this.isContentEditable(t)))return!0;return!1}},{key:"isFirstTextChild",value:function(e,t){for(var n=e.childNodes,a=0;a<n.length;a++){var o=n[a];if(o.nodeType!==Node.COMMENT_NODE&&o.textContent)return o===t}return!1}},{key:"isLastTextChild",value:function(e,t){for(var n=e.childNodes,a=n.length-1;-1<a;a--){var o=n[a];if(o.nodeType!==Node.COMMENT_NODE&&o.textContent)return o===t}return!1}},{key:"spacingNodeByXPath",value:function(e,t){if(t instanceof Node&&!(t instanceof DocumentFragment))for(var n,a=document.evaluate(e,t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),o=a.snapshotLength-1;-1<o;--o){var i,r,c=a.snapshotItem(o);if(this.isSpecificTag(c.parentNode,this.presentationalTags)&&!this.isInsideSpecificTag(c.parentNode,this.ignoredTags)&&((s=c.parentNode).previousSibling&&(r=s.previousSibling).nodeType===Node.TEXT_NODE&&(i=r.data.substr(-1)+c.data.toString().charAt(0))!==this.spacing(i)&&(r.data="".concat(r.data," ")),s.nextSibling)&&(i=s.nextSibling).nodeType===Node.TEXT_NODE&&(r=c.data.substr(-1)+i.data.toString().charAt(0))!==this.spacing(r)&&(i.data=" ".concat(i.data)),!this.canIgnoreNode(c)){var s=this.spacing(c.data);if(c.data!==s&&(c.data=s),n){if(c.nextSibling&&0<=c.nextSibling.nodeName.search(this.spaceLikeTags)){n=c;continue}var u=c.data.toString().substr(-1)+n.data.toString().substr(0,1);if(this.spacing(u)!==u){for(var p=n;p.parentNode&&-1===p.nodeName.search(this.spaceSensitiveTags)&&this.isFirstTextChild(p.parentNode,p);)p=p.parentNode;for(var l=c;l.parentNode&&-1===l.nodeName.search(this.spaceSensitiveTags)&&this.isLastTextChild(l.parentNode,l);)l=l.parentNode;if(l.nextSibling&&0<=l.nextSibling.nodeName.search(this.spaceLikeTags)){n=c;continue}-1===l.nodeName.search(this.blockTags)&&(-1===p.nodeName.search(this.spaceSensitiveTags)?-1===p.nodeName.search(this.ignoredTags)&&-1===p.nodeName.search(this.blockTags)&&(n.previousSibling?-1===n.previousSibling.nodeName.search(this.spaceLikeTags)&&(n.data=" ".concat(n.data)):this.canIgnoreNode(n)||(n.data=" ".concat(n.data))):-1===l.nodeName.search(this.spaceSensitiveTags)?c.data="".concat(c.data," "):((u=document.createElement("pangu")).innerHTML=" ",p.previousSibling&&-1!==p.previousSibling.nodeName.search(this.spaceLikeTags)||p.parentNode.insertBefore(u,p),u.previousElementSibling||u.parentNode&&u.parentNode.removeChild(u)))}}}n=c}}},{key:"spacingNode",value:function(e){var t=".//*/text()[normalize-space(.)]";e.children&&0===e.children.length&&(t=".//text()[normalize-space(.)]"),this.spacingNodeByXPath(t,e)}},{key:"spacingElementById",value:function(e){e='id("'.concat(e,'")//text()'),this.spacingNodeByXPath(e,document)}},{key:"spacingElementByClassName",value:function(e){e='//*[contains(concat(" ", normalize-space(@class), " "), "'.concat(e,'")]//text()'),this.spacingNodeByXPath(e,document)}},{key:"spacingElementByTagName",value:function(e){e="//".concat(e,"//text()"),this.spacingNodeByXPath(e,document)}},{key:"spacingPageTitle",value:function(){this.spacingNodeByXPath("/html/head/title/text()",document)}},{key:"spacingPageBody",value:function(){var t="/html/body//*/text()[normalize-space(.)]";["script","style","textarea"].forEach(function(e){t="".concat(t,'[translate(name(..),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")!="').concat(e,'"]')}),this.spacingNodeByXPath(t,document)}},{key:"spacingPage",value:function(){this.spacingPageTitle(),this.spacingPageBody()}},{key:"autoSpacingPage",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2e3;if(document.body instanceof Node&&!this.isAutoSpacingPageExecuted){this.isAutoSpacingPageExecuted=!0;var a=this,o=function(e){var t=this,n=arguments,a=!1;return function(){a||(a=!0,e.apply(t,n))}}(function(){a.spacingPage()}),i=document.getElementsByTagName("video");if(0===i.length)setTimeout(function(){o()},e);else for(var r=0;r<i.length;r++){var c=i[r];if(4===c.readyState){setTimeout(function(){o()},3e3);break}c.addEventListener("loadeddata",function(){setTimeout(function(){o()},4e3)})}var s=[],u=function(a,o,i){var r=this,c=arguments,s=null,u=null;return function(){var e=r,t=c,n=+new Date;clearTimeout(s),i<=n-(u=u||n)?(a.apply(e,t),u=n):s=setTimeout(function(){a.apply(e,t)},o)}}(function(){for(;s.length;){var e=s.shift();e&&a.spacingNode(e)}},t,{maxWait:n});new MutationObserver(function(e,t){e.forEach(function(e){switch(e.type){case"childList":e.addedNodes.forEach(function(e){e.nodeType===Node.ELEMENT_NODE?s.push(e):e.nodeType===Node.TEXT_NODE&&s.push(e.parentNode)});break;case"characterData":var t=e.target;t.nodeType===Node.TEXT_NODE&&s.push(t.parentNode)}}),u()}).observe(document.body,{characterData:!0,childList:!0,subtree:!0})}}}],i=0;i<o.length;i++){var r=o[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}return t})(a(1).Pangu),t=new e;n.exports=t,n.exports.default=t,n.exports.Pangu=e})?t.apply(e,[]):t)&&(n.exports=e)},function(D,e,t){var n;void 0!==(e="function"==typeof(n=function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}for(var e="⺀-⻿⼀-⿟぀-ゟ゠-ヺー-ヿ㄀-ㄯ㈀-㋿㐀-䶿一-鿿豈-﫿",n=new RegExp("[".concat(e,"]")),a=new RegExp("([".concat(e,"])[ ]*([\\:]+|\\.)[ ]*([").concat(e,"])"),"g"),i=new RegExp("([".concat(e,"])[ ]*([~\\!;,\\?]+)[ ]*"),"g"),r=new RegExp("([\\.]{2,}|…)([".concat(e,"])"),"g"),c=new RegExp("([".concat(e,"])\\:([A-Z0-9\\(\\)])"),"g"),s=new RegExp("([".concat(e,'])([`"״])'),"g"),u=new RegExp('([`"״])(['.concat(e,"])"),"g"),p=/([`"\u05f4]+)[ ]*(.+?)[ ]*([`"\u05f4]+)/g,l=new RegExp("([".concat(e,"])('[^s])"),"g"),g=new RegExp("(')([".concat(e,"])"),"g"),d=new RegExp("([A-Za-z0-9".concat(e,"])( )('s)"),"g"),f=new RegExp("([".concat(e,"])(#)([").concat(e,"]+)(#)([").concat(e,"])"),"g"),h=new RegExp("([".concat(e,"])(#([^ ]))"),"g"),y=new RegExp("(([^ ])#)([".concat(e,"])"),"g"),v=new RegExp("([".concat(e,"])([\\+\\-\\*\\/=&\\|<>])([A-Za-z0-9])"),"g"),b=new RegExp("([A-Za-z0-9])([\\+\\-\\*\\/=&\\|<>])([".concat(e,"])"),"g"),m=/([\/]) ([a-z\-_\.\/]+)/g,T=/([\/\.])([A-Za-z\-_\.\/]+) ([\/])/g,N=new RegExp("([".concat(e,"])([\\(\\[\\{<>“])"),"g"),$=new RegExp("([\\)\\]\\}<>”])([".concat(e,"])"),"g"),x=/([\(\[\{<\u201c]+)[ ]*(.+?)[ ]*([\)\]\}>\u201d]+)/,E=new RegExp("([A-Za-z0-9".concat(e,"])[ ]*([“])([A-Za-z0-9").concat(e,"\\-_ ]+)([”])"),"g"),S=new RegExp("([“])([A-Za-z0-9".concat(e,"\\-_ ]+)([”])[ ]*([A-Za-z0-9").concat(e,"])"),"g"),w=/([A-Za-z0-9])([\(\[\{])/g,P=/([\)\]\}])([A-Za-z0-9])/g,k=new RegExp("([".concat(e,"])([A-Za-zͰ-Ͽ0-9@\\$%\\^&\\*\\-\\+\\\\=\\|/¡-ÿ⅐-↏✀—➿])"),"g"),O=new RegExp("([A-Za-zͰ-Ͽ0-9~\\$%\\^&\\*\\-\\+\\\\=\\|/!;:,\\.\\?¡-ÿ⅐-↏✀—➿])([".concat(e,"])"),"g"),_=/(%)([A-Za-z])/g,R=/([ ]*)([\u00b7\u2022\u2027])([ ]*)/g,B=C.prototype,o=[{key:"convertToFullwidth",value:function(e){return e.replace(/~/g,"～").replace(/!/g,"！").replace(/;/g,"；").replace(/:/g,"：").replace(/,/g,"，").replace(/\./g,"。").replace(/\?/g,"？")}},{key:"spacing",value:function(e){var o;return"string"!=typeof e?(console.warn("spacing(text) only accepts string but got ".concat(t(e))),e):e.length<=1||!n.test(e)?e:(o=this,e.replace(a,function(e,t,n,a){return n=o.convertToFullwidth(n),"".concat(t).concat(n).concat(a)}).replace(i,function(e,t,n){return n=o.convertToFullwidth(n),"".concat(t).concat(n)}).replace(r,"$1 $2").replace(c,"$1：$2").replace(s,"$1 $2").replace(u,"$1 $2").replace(p,"$1$2$3").replace(l,"$1 $2").replace(g,"$1 $2").replace(d,"$1's").replace(f,"$1 $2$3$4 $5").replace(h,"$1 $2").replace(y,"$1 $3").replace(v,"$1 $2 $3").replace(b,"$1 $2 $3").replace(m,"$1$2").replace(T,"$1$2$3").replace(N,"$1 $2").replace($,"$1 $2").replace(x,"$1$2$3").replace(E,"$1 $2$3$4").replace(S,"$1$2$3 $4").replace(w,"$1 $2").replace(P,"$1 $2").replace(k,"$1 $2").replace(O,"$1 $2").replace(_,"$1 $2").replace(R,"・"))}},{key:"spacingText",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};try{t=this.spacing(e)}catch(e){return void n(e)}n(null,t)}},{key:"spacingTextSync",value:function(e){return this.spacing(e)}}],A=0;A<o.length;A++){var j=o[A];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(B,j.key,j)}var z=new(e=C);function C(){if(!(this instanceof C))throw new TypeError("Cannot call a class as a function");this.version="4.0.7"}D.exports=z,D.exports.default=z,D.exports.Pangu=e})?n.apply(e,[]):n)&&(D.exports=e)}],a={},o.m=n,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0);function o(e){var t;return(a[e]||(t=a[e]={i:e,l:!1,exports:{}},n[e].call(t.exports,t,t.exports,o),t.l=!0,t)).exports}var n,a});