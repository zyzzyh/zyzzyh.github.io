((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).mediumZoom=t()})(this,function(){function l(e){return".svg"===(e.currentSrc||e.src).substr(-4).toLowerCase()}function a(e){try{return Array.isArray(e)?e.filter(o):NodeList.prototype.isPrototypeOf(e)?[].slice.call(e).filter(o):w(e)?[e].filter(o):"string"==typeof e?[].slice.call(document.querySelectorAll(e)).filter(o):[]}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}}function b(e,t){var o,t=E({bubbles:!1,cancelable:!1,detail:void 0},t);return"function"==typeof window.CustomEvent?new CustomEvent(e,t):((o=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o)}var e,t,E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o=function(e){return"IMG"===e.tagName},w=function(e){return e&&1===e.nodeType},n=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}",i={}.insertAt;return"undefined"!=typeof document&&(e=document.head||document.getElementsByTagName("head")[0],(t=document.createElement("style")).type="text/css","top"===i&&e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))),function e(t,o){function n(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var i=t.reduce(function(e,t){return[].concat(e,a(t))},[]);return i.filter(function(e){return-1===f.indexOf(e)}).forEach(function(e){f.push(e),e.classList.add("medium-zoom-image")}),m.forEach(function(e){var t=e.type,o=e.listener,n=e.options;i.forEach(function(e){e.addEventListener(t,o,n)})}),y}function i(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return z.original?s():d({target:e})}function d(){function c(){var e={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},t=void 0,o=void 0,t=(h.container&&(h.container instanceof Object?(t=(e=E({},e,h.container)).width-e.left-e.right-2*h.margin,o=e.height-e.top-e.bottom-2*h.margin):(a=(n=(w(h.container)?h.container:document.querySelector(h.container)).getBoundingClientRect()).width,e=E({},e,{width:a,height:n.height,left:n.left,top:n.top}))),t||e.width-2*h.margin),o=o||e.height-2*h.margin,n=!l(a=z.zoomedHd||z.original)&&a.naturalWidth||t,i=!l(a)&&a.naturalHeight||o,d=(a=a.getBoundingClientRect()).top,r=a.left,m=a.width,a=a.height,n=Math.min(Math.max(m,n),t)/m,i=Math.min(Math.max(a,i),o)/a,i="scale("+(n=Math.min(n,i))+") translate3d("+((t-m)/2-r+h.margin+e.left)/n+"px, "+((o-a)/2-d+h.margin+e.top)/n+"px, 0)";z.zoomed.style.transform=i,z.zoomedHd&&(z.zoomedHd.style.transform=i)}var u=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return new r(function(t){if(u&&-1===f.indexOf(u))t(y);else if(z.zoomed)t(y);else{if(u)z.original=u;else{if(!(0<f.length))return void t(y);var e=f;z.original=e[0]}var o,n;z.original.dispatchEvent(b("medium-zoom:open",{detail:{zoom:y}})),g=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,p=!0,z.zoomed=(d=(i=(e=z.original).getBoundingClientRect()).top,r=i.left,m=i.width,i=i.height,e=e.cloneNode(),a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,l=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,e.removeAttribute("id"),e.style.position="absolute",e.style.top=d+a+"px",e.style.left=r+l+"px",e.style.width=m+"px",e.style.height=i+"px",e.style.transform="",e),document.body.appendChild(v),h.template&&(d=w(h.template)?h.template:document.querySelector(h.template),z.template=document.createElement("div"),z.template.appendChild(d.content.cloneNode(!0)),document.body.appendChild(z.template)),z.original.parentElement&&"PICTURE"===z.original.parentElement.tagName&&z.original.currentSrc&&(z.zoomed.src=z.original.currentSrc),document.body.appendChild(z.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),z.original.classList.add("medium-zoom-image--hidden"),z.zoomed.classList.add("medium-zoom-image--opened"),z.zoomed.addEventListener("click",s),z.zoomed.addEventListener("transitionend",function e(){p=!1,z.zoomed.removeEventListener("transitionend",e),z.original.dispatchEvent(b("medium-zoom:opened",{detail:{zoom:y}})),t(y)}),z.original.getAttribute("data-zoom-src")?(z.zoomedHd=z.zoomed.cloneNode(),z.zoomedHd.removeAttribute("srcset"),z.zoomedHd.removeAttribute("sizes"),z.zoomedHd.removeAttribute("loading"),z.zoomedHd.src=z.zoomed.getAttribute("data-zoom-src"),z.zoomedHd.onerror=function(){clearInterval(o),console.warn("Unable to reach the zoom image target "+z.zoomedHd.src),z.zoomedHd=null,c()},o=setInterval(function(){z.zoomedHd.complete&&(clearInterval(o),z.zoomedHd.classList.add("medium-zoom-image--opened"),z.zoomedHd.addEventListener("click",s),document.body.appendChild(z.zoomedHd),c())},10)):z.original.hasAttribute("srcset")?(z.zoomedHd=z.zoomed.cloneNode(),z.zoomedHd.removeAttribute("sizes"),z.zoomedHd.removeAttribute("loading"),n=z.zoomedHd.addEventListener("load",function(){z.zoomedHd.removeEventListener("load",n),z.zoomedHd.classList.add("medium-zoom-image--opened"),z.zoomedHd.addEventListener("click",s),document.body.appendChild(z.zoomedHd),c()})):c()}var i,d,r,m,a,l})}var r=window.Promise||function(e){function t(){}e(t,t)},s=function(){return new r(function(t){!p&&z.original?(p=!0,document.body.classList.remove("medium-zoom--opened"),z.zoomed.style.transform="",z.zoomedHd&&(z.zoomedHd.style.transform=""),z.template&&(z.template.style.transition="opacity 150ms",z.template.style.opacity=0),z.original.dispatchEvent(b("medium-zoom:close",{detail:{zoom:y}})),z.zoomed.addEventListener("transitionend",function e(){z.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(z.zoomed),z.zoomedHd&&document.body.removeChild(z.zoomedHd),document.body.removeChild(v),z.zoomed.classList.remove("medium-zoom-image--opened"),z.template&&document.body.removeChild(z.template),p=!1,z.zoomed.removeEventListener("transitionend",e),z.original.dispatchEvent(b("medium-zoom:closed",{detail:{zoom:y}})),z.original=null,z.zoomed=null,z.zoomedHd=null,z.template=null,t(y)})):t(y)})},f=[],m=[],p=!1,g=0,h=1<arguments.length&&void 0!==o?o:{},z={original:null,zoomed:null,zoomedHd:null,template:null},v=("[object Object]"===Object.prototype.toString.call(t)?h=t:!t&&"string"!=typeof t||n(t),o=(h=E({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},h)).background,(t=document.createElement("div")).classList.add("medium-zoom-overlay"),t.style.background=o,t),y=(document.addEventListener("click",function(e){(e=e.target)!==v?-1!==f.indexOf(e)&&i({target:e}):s()}),document.addEventListener("keyup",function(e){"Escape"!==(e=e.key||e.keyCode)&&"Esc"!==e&&27!==e||s()}),document.addEventListener("scroll",function(){var e;!p&&z.original&&(e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,Math.abs(g-e)>h.scrollOffset)&&setTimeout(s,150)}),window.addEventListener("resize",s),{open:d,close:s,toggle:i,update:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e;return e.background&&(v.style.background=e.background),e.container&&e.container instanceof Object&&(t.container=E({},h.container,e.container)),e.template&&(e=w(e.template)?e.template:document.querySelector(e.template),t.template=e),h=E({},h,t),f.forEach(function(e){e.dispatchEvent(b("medium-zoom:update",{detail:{zoom:y}}))}),y},clone:function(){return e(E({},h,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}))},attach:n,detach:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];z.zoomed&&s();var n=0<t.length?t.reduce(function(e,t){return[].concat(e,a(t))},[]):f;return n.forEach(function(e){e.classList.remove("medium-zoom-image"),e.dispatchEvent(b("medium-zoom:detach",{detail:{zoom:y}}))}),f=f.filter(function(e){return-1===n.indexOf(e)}),y},on:function(t,o){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return f.forEach(function(e){e.addEventListener("medium-zoom:"+t,o,n)}),m.push({type:"medium-zoom:"+t,listener:o,options:n}),y},off:function(t,o){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return f.forEach(function(e){e.removeEventListener("medium-zoom:"+t,o,n)}),m=m.filter(function(e){return!(e.type==="medium-zoom:"+t&&e.listener.toString()===o.toString())}),y},getOptions:function(){return h},getImages:function(){return f},getZoomedImage:function(){return z.original}});return y}});